<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Crossword</title>
    <style>
        /* RESET & BODY */
        * { box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif; }
        body { 
            margin: 0; 
            padding: 20px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            background-color: #fff; 
            min-height: 100vh;
        }

        /* HEADER */
        h2 { margin: 0 0 5px 0; font-size: 1.8rem; text-align: center; }
        p { margin: 0 0 20px 0; color: #666; text-align: center; font-size: 1rem; }

        /* GAME CONTAINER */
        #game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            width: 100%;
            max-width: 800px;
        }

        /* GRID */
        #crossword-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr); /* 12 Cols for layout */
            gap: 2px;
            background-color: #000;
            padding: 2px;
            border: 2px solid #000;
        }

        .cell {
            width: 30px;
            height: 30px;
            background-color: #fff;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1rem;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            user-select: none;
        }

        .cell.black {
            background-color: #000;
            cursor: default;
            border: none;
        }

        .cell.selected { background-color: #a7d8ff; }
        .cell.related { background-color: #e8f5ff; }

        .cell .number {
            position: absolute;
            top: 1px;
            left: 2px;
            font-size: 0.5rem;
            font-weight: normal;
            color: #333;
        }

        .cell .letter { z-index: 1; }

        /* CLUES */
        #clues-container {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            width: 100%;
            margin-top: 10px;
            gap: 20px;
        }

        .clue-column {
            flex: 1;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }

        h3 { font-size: 1rem; margin-top: 0; border-bottom: 2px solid #ddd; padding-bottom: 5px; }

        .clue-item {
            font-size: 0.85rem;
            margin-bottom: 8px;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
        }
        .clue-item:hover { background-color: #e9ecef; }
        .clue-item.active { background-color: #a7d8ff; font-weight: 600; }
        .clue-number { font-weight: 800; margin-right: 5px; }

        /* WIN MODAL */
        #win-overlay {
            display: none;
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border: 3px solid #000;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            z-index: 100;
        }
        .btn {
            background: #000; color: #fff;
            padding: 10px 20px; text-decoration: none;
            border-radius: 6px; font-weight: bold;
            display: inline-block; margin-top: 15px;
        }

        @media (max-width: 600px) {
            #clues-container { flex-direction: column; }
            .cell { width: 26px; height: 26px; font-size: 0.9rem; }
        }
    </style>
</head>
<body>

    <h2>The "Max" Mini</h2>
    <p>Tap a clue or cell to start.</p>

    <div id="game-container">
        <div id="crossword-grid"></div>

        <div id="clues-container">
            <div class="clue-column">
                <h3>Across</h3>
                <div id="across-clues"></div>
            </div>
            <div class="clue-column">
                <h3>Down</h3>
                <div id="down-clues"></div>
            </div>
        </div>
    </div>

    <div id="win-overlay">
        <h2>Puzzle Solved! ðŸ§ </h2>
        <p>You know me too well.</p>
        <a href="#" onclick="location.reload()" class="btn">Play Again</a>
    </div>

    <script>
        // GRID LAYOUT BASED ON SKETCH
        const gridLayout = [
            ['T', 'E', 'N', 'N', 'I', 'S', '.', '.', '.', '.', '.', '.'],
            ['.', '.', '.', '.', '.', 'I', '.', '.', '.', '.', '.', '.'],
            ['.', '.', '.', '.', '.', 'M', '.', '.', '.', '.', '.', '.'],
            ['.', '.', '.', '.', '.', 'P', '.', 'H', 'O', 'T', 'E', 'L'],
            ['.', '.', '.', '.', '.', 'S', '.', '.', 'S', '.', '.', '.'],
            ['.', '.', '.', '.', '.', 'O', '.', '.', 'T', 'C', 'M', '.'],
            ['.', '.', 'C', 'O', 'R', 'N', 'E', 'L', 'L', '.', '.', '.'],
            ['.', '.', 'O', '.', '.', 'S', '.', '.', 'U', '.', '.', '.'],
            ['.', '.', 'N', '.', '.', '.', '.', '.', 'N', '.', '.', '.'],
            ['.', '.', 'D', '.', '.', '.', '.', '.', 'D', '.', '.', '.'],
            ['.', '.', 'E', 'N', 'R', 'O', 'N', '.', '.', '.', '.', '.']
        ];

        // WORD DATA
        const words = [
            { number: 1, direction: 'across', row: 0, col: 0, answer: "TENNIS", clue: "My current favorite sport" },
            { number: 1, direction: 'down', row: 0, col: 5, answer: "SIMPSONS", clue: "Yellow, animated family I grew up with" },
            { number: 2, direction: 'across', row: 3, col: 7, answer: "HOTEL", clue: "Dream: Create a murder mystery themed one" },
            { number: 3, direction: 'down', row: 3, col: 8, answer: "OSTLUND", clue: "Ruben ____ (Director of Triangle of Sadness)" },
            { number: 4, direction: 'across', row: 5, col: 8, answer: "TCM", clue: "My fav TV channel (promos by Sibling Rivalry)" },
            { number: 5, direction: 'across', row: 6, col: 2, answer: "CORNELL", clue: "My and Andy Bernardâ€™s alma mater" },
            { number: 5, direction: 'down', row: 6, col: 2, answer: "CONDE", clue: "First name of magazine publisher (Vogue, New Yorker)" },
            { number: 6, direction: 'across', row: 10, col: 2, answer: "ENRON", clue: "____: The Smartest Guys in The Room" }
        ];

        let currentDirection = 'across'; 
        let currentWordIndex = 0; 

        const gridElement = document.getElementById('crossword-grid');
        const acrossCluesElement = document.getElementById('across-clues');
        const downCluesElement = document.getElementById('down-clues');

        function initGrid() {
            gridElement.style.gridTemplateRows = `repeat(${gridLayout.length}, 1fr)`;
            
            for(let r=0; r<gridLayout.length; r++) {
                for(let c=0; c<gridLayout[0].length; c++) {
                    const char = gridLayout[r][c];
                    const cell = document.createElement('div');
                    cell.className = `cell ${char === '.' ? 'black' : ''}`;
                    cell.dataset.row = r;
                    cell.dataset.col = c;
                    cell.dataset.answer = char;

                    if(char !== '.') {
                        const wordStart = words.find(w => w.row === r && w.col === c);
                        if(wordStart) {
                            const numSpan = document.createElement('span');
                            numSpan.className = 'number';
                            numSpan.innerText = wordStart.number;
                            cell.appendChild(numSpan);
                        }
                        const letterSpan = document.createElement('span');
                        letterSpan.className = 'letter';
                        cell.appendChild(letterSpan);
                        cell.addEventListener('click', () => handleCellClick(r, c));
                    }
                    gridElement.appendChild(cell);
                }
            }
            renderClues();
        }

        function renderClues() {
            words.forEach((word, index) => {
                const el = document.createElement('div');
                el.className = 'clue-item';
                el.id = `clue-${index}`;
                el.innerHTML = `<span class="clue-number">${word.number}</span> ${word.clue}`;
                el.onclick = () => selectWord(index);
                if(word.direction === 'across') acrossCluesElement.appendChild(el);
                else downCluesElement.appendChild(el);
            });
        }

        function handleCellClick(r, c) {
            const possibleWords = words.filter(w => {
                if(w.direction === 'across') return w.row === r && c >= w.col && c < w.col + w.answer.length;
                else return w.col === c && r >= w.row && r < w.row + w.answer.length;
            });
            if(possibleWords.length === 0) return;

            if(possibleWords.length > 1) {
                const currentWord = words[currentWordIndex];
                if(currentWord && possibleWords.includes(currentWord) && isActive(r,c)) {
                    const other = possibleWords.find(w => w !== currentWord);
                    selectWord(words.indexOf(other));
                } else {
                    const pref = possibleWords.find(w => w.direction === 'across') || possibleWords[0];
                    selectWord(words.indexOf(pref));
                }
            } else {
                selectWord(words.indexOf(possibleWords[0]));
            }
        }

        function isActive(r, c) {
            return document.querySelector(`.cell[data-row="${r}"][data-col="${c}"]`).classList.contains('selected');
        }

        function selectWord(index) {
            currentWordIndex = index;
            const word = words[index];
            currentDirection = word.direction;

            document.querySelectorAll('.cell').forEach(c => { c.classList.remove('selected', 'related'); });
            document.querySelectorAll('.clue-item').forEach(c => c.classList.remove('active'));

            for(let i=0; i<word.answer.length; i++) {
                let r = word.row + (word.direction === 'down' ? i : 0);
                let c = word.col + (word.direction === 'across' ? i : 0);
                const cell = document.querySelector(`.cell[data-row="${r}"][data-col="${c}"]`);
                cell.classList.add('related');
                if(i===0) cell.classList.add('selected'); 
            }
            document.getElementById(`clue-${index}`).classList.add('active');
        }

        document.addEventListener('keydown', (e) => {
            const word = words[currentWordIndex];
            if(!word) return;
            const char = e.key.toUpperCase();
            
            let selectedCell = document.querySelector('.cell.selected');
            if(!selectedCell) {
                const related = document.querySelectorAll('.cell.related');
                if(related.length > 0) selectedCell = related[0];
            }
            if(!selectedCell) return;

            let r = parseInt(selectedCell.dataset.row);
            let c = parseInt(selectedCell.dataset.col);
            let indexInWord = (word.direction === 'across') ? (c - word.col) : (r - word.row);

            if(/^[A-Z]$/.test(char)) {
                selectedCell.querySelector('.letter').innerText = char;
                checkWin();
                if(indexInWord < word.answer.length - 1) {
                    let nextR = r + (word.direction === 'down' ? 1 : 0);
                    let nextC = c + (word.direction === 'across' ? 1 : 0);
                    updateCursor(nextR, nextC);
                }
            } else if(e.key === 'Backspace') {
                if(selectedCell.querySelector('.letter').innerText !== "") {
                    selectedCell.querySelector('.letter').innerText = "";
                } else {
                    if(indexInWord > 0) {
                        let prevR = r - (word.direction === 'down' ? 1 : 0);
                        let prevC = c - (word.direction === 'across' ? 1 : 0);
                        updateCursor(prevR, prevC);
                    }
                }
            }
        });

        function updateCursor(r, c) {
            document.querySelectorAll('.cell').forEach(cell => cell.classList.remove('selected'));
            const next = document.querySelector(`.cell[data-row="${r}"][data-col="${c}"]`);
            if(next) next.classList.add('selected');
        }

        function checkWin() {
            let allCorrect = true;
            document.querySelectorAll('.cell:not(.black)').forEach(cell => {
                const letter = cell.querySelector('.letter').innerText;
                if(letter !== cell.dataset.answer) allCorrect = false;
            });
            if(allCorrect) {
                setTimeout(() => { document.getElementById('win-overlay').style.display = 'block'; }, 500);
            }
        }

        initGrid();
        selectWord(0);
        updateCursor(0,0);
    </script>
</body>
</html>
